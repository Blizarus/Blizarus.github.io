<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Novel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* Стили для кнопки "Back to Top" */
        #backToTopBtn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: none; /* Изначально скрыта */
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 20px;
            width: 50px;
            height: 50px;
            cursor: pointer;
        }

        #backToTopBtn:hover {
            background-color: #0056b3;
        }
    </style>
    <script>
        // Функция для получения параметра из URL
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Функция для перехода на главную страницу
        function goToHomePage() {
            window.location.href = "index.html"; // Путь к главной странице
        }

        // Подгрузка данных новеллы
        async function loadNovel() {
            const novelId = getQueryParam("novel");
            if (!novelId) {
                document.getElementById("content").innerHTML = "<p class='text-danger'>Novel not found!</p>";
                return;
            }

            const response = await fetch(`novels/${novelId}/novel.json`);
            if (!response.ok) {
                document.getElementById("content").innerHTML = `<p class='text-danger'>Error loading novel data for '${novelId}'.</p>`;
                return;
            }

            const novelData = await response.json();
            document.getElementById("title").innerText = novelData.title;
            document.getElementById("description").innerText = novelData.description;

            const chapterList = document.getElementById("chapters");
            novelData.chapters.forEach(chapter => {
                const li = document.createElement("li");
                li.className = "list-group-item";
                li.innerHTML = `<a href="chapter_template.html?novel=${novelId}&chapter=${chapter.filename}" class="text-decoration-none">${chapter.title}</a>`;
                chapterList.appendChild(li);
            });
        }

        // Показ кнопки при прокрутке страницы
        window.onscroll = function() {
            const backToTopBtn = document.getElementById("backToTopBtn");
            if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
                backToTopBtn.style.display = "block"; // Показываем кнопку
            } else {
                backToTopBtn.style.display = "none"; // Скрываем кнопку
            }
        };

        // Функция для прокрутки наверх
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: "smooth" });
        }

        document.addEventListener("DOMContentLoaded", loadNovel);
    </script>
</head>
<body class="container my-5">
    <div class="text-center my-4">
        <button onclick="goToHomePage()" class="btn btn-primary">Go to Home</button>
    </div>
    <h1 id="title">Loading...</h1>
    <p id="description"></p>
    <h2>Chapters</h2>
    <ul id="chapters" class="list-group"></ul>
    <div id="content"></div>

    <!-- Кнопка "Back to Top" -->
    <button id="backToTopBtn" onclick="scrollToTop()">↑</button>
</body>
</html>
