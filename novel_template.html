<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Novel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script>
        // Функция для получения параметра из URL
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Подгрузка данных новеллы
        async function loadNovel() {
            const novelId = getQueryParam("novel");
            if (!novelId) {
                document.getElementById("content").innerHTML = "<p class='text-danger'>Novel not found!</p>";
                return;
            }

            const response = await fetch(`novels/${novelId}/novel.json`);
            if (!response.ok) {
                document.getElementById("content").innerHTML = `<p class='text-danger'>Error loading novel data for '${novelId}'.</p>`;
                return;
            }

            const novelData = await response.json();
            document.getElementById("title").innerText = novelData.title;
            document.getElementById("description").innerText = novelData.description;

            const chapterList = document.getElementById("chapters");
            novelData.chapters.forEach(chapter => {
                const li = document.createElement("li");
                li.className = "list-group-item";
                li.innerHTML = `<a href="chapter_template.html?novel=${novelId}&chapter=${chapter.filename}" class="text-decoration-none">${chapter.title}</a>`;
                chapterList.appendChild(li);
            });
        }

        document.addEventListener("DOMContentLoaded", loadNovel);
    </script>
</head>
<body class="container my-5">
    <h1 id="title">Loading...</h1>
    <p id="description"></p>
    <h2>Chapters</h2>
    <ul id="chapters" class="list-group"></ul>
    <div id="content"></div>
</body>
</html>
